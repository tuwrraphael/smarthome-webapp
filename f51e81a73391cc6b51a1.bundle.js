(self.webpackChunksmarthome=self.webpackChunksmarthome||[]).push([[880],{1880:function(e,t,o){"use strict";o.r(t),o.d(t,{HomeComponent:function(){return l}}),o(285);var n=o(7521),i=o.n(n);class l extends HTMLElement{constructor(){super(),this.innerHTML=i()}connectedCallback(){this.abortContoller=new AbortController,this.querySelector("#lauter").addEventListener("click",(()=>this.lauterClick()),{signal:this.abortContoller.signal}),this.querySelector("#leiser").addEventListener("click",(()=>this.leiserClick()),{signal:this.abortContoller.signal}),this.querySelector("#quelleAlexa").addEventListener("click",(()=>this.quelleAlexaClick()),{signal:this.abortContoller.signal}),this.querySelector("#quelleMonitor").addEventListener("click",(()=>this.quelleMonitorClick()),{signal:this.abortContoller.signal}),this.querySelector("#toggleDBFB").addEventListener("click",(()=>this.toggleDBFBClick()),{signal:this.abortContoller.signal})}setGoogleAccessToken(e){this.googleAccessToken=e}async executeParticleFunction(e,t){let o=await this.getParticleToken(),n=new URLSearchParams;n.set("arg",t),await fetch(`https://api.particle.io/v1/devices/4e0033000651343530343432/${e}`,{method:"POST",body:n,headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/x-www-form-urlencoded"}})}async lauterClick(){await this.executeParticleFunction("control","i")}async leiserClick(){await this.executeParticleFunction("control","d")}async quelleAlexaClick(){await this.executeParticleFunction("control","v")}async quelleMonitorClick(){await this.executeParticleFunction("control","c")}async toggleDBFBClick(){await this.executeParticleFunction("control","b")}disconnectedCallback(){this.abortContoller.abort()}async getParticleToken(){if(null!=this.particleToken&&+new Date<this.particleToken.exp)return this.particleToken.token;let e=new URLSearchParams;e.set("grant_type","urn:ietf:params:oauth:grant-type:token-exchange"),e.set("subject_token",this.googleAccessToken),e.set("subject_token_type","urn:ietf:params:oauth:token-type:access_token");let t=await fetch("https://particle-google-auth-bridge.grapp.workers.dev/token",{method:"POST",body:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!t.ok)throw new Error(`Could not acquire particle token: Status: ${t.status}`);let o=await t.json(),n=+new Date+1e3*parseInt(o.expires_in);return this.particleToken={exp:n,token:o.access_token},this.particleToken.token}}customElements.define("home-component",l)},7521:function(e){e.exports='<h2>Volume</h2> <button id="lauter">+ lauter</button> <button id="leiser">- leiser</button> <h2>Quelle</h2> <button id="quelleAlexa">Alexa</button> <button id="quelleMonitor">Monitor</button> <h2>Sound</h2> <button id="toggleDBFB">DBFB</button>'}}]);
//# sourceMappingURL=f51e81a73391cc6b51a1.bundle.js.map